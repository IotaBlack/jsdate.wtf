<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JS Date WTF - The JavaScript Date Quiz</title>
  <style>
    /* Dark theme (default) */
    :root {
      /* Colors - Wong Color Palette (Colorblind Friendly) */
      --color-primary: #E69F00;
      /* Orange */
      --color-primary-hover: #CC8800;
      /* Darker Orange */
      --color-secondary: #0072B2;
      /* Blue */
      --color-secondary-hover: #005A8F;
      /* Darker Blue */
      --color-bg-dark: #0F0F0F;
      /* Near Black */
      --color-bg-medium: #1A1A1A;
      /* Dark Gray */
      --color-bg-light: #2A2A2A;
      /* Medium Gray */
      --color-bg-lighter: #3A3A3A;
      /* Light Gray */
      --color-text-primary: #F5F5F5;
      /* Off White */
      --color-text-secondary: #B0B0B0;
      /* Light Gray Text */
      --color-border: #404040;
      /* Border Gray */
      --color-border-hover: #505050;
      /* Hover Border Gray */
      --color-border-light: #484848;
      /* Light Border Gray */
      --color-error: #D55E00;
      /* Vermillion/Red-Orange */
      --color-correct-bg: rgba(0, 158, 115, 0.15);
      /* Green tint with transparency */
      --color-incorrect-bg: rgba(213, 94, 0, 0.15);
      /* Vermillion tint with transparency */
      --color-accent-green: #009E73;
      /* Green from Wong palette */
      --color-code-bg: #0F0F0F;
      /* Code block background */
      --shadow-strength: 0.5;

      /* Syntax highlighting colors */
      --syntax-keyword: #56B4E9;
      /* Sky Blue from Wong palette */
      --syntax-string: #009E73;
      /* Green from Wong palette */
      --syntax-number: #F0E442;
      /* Yellow from Wong palette */
      --syntax-operator: #B0B0B0;
      /* Grey for operators and punctuation */
      --syntax-function: #E69F00;
      /* Orange from Wong palette */
      --syntax-comment: #B0B0B0;
      /* Gray */

      /* Spacing */
      --spacing-xs: 4px;
      --spacing-sm: 8px;
      --spacing-md: 12px;
      --spacing-lg: 15px;
      --spacing-xl: 20px;
      --spacing-2xl: 25px;
      --spacing-3xl: 30px;
      --spacing-4xl: 40px;

      /* Typography */
      --font-system: Avenir, Montserrat, Corbel, 'URW Gothic', source-sans-pro, sans-serif;
      --font-mono: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace;
      --font-size-sm: 0.9em;
      --font-size-base: 1em;
      --font-size-lg: 1.1em;
      --font-size-xl: 2em;
      --font-size-2xl: 2.5em;
      --font-size-3xl: 3em;
      --line-height: 1.6;

      /* Border Radius */
      --radius-sm: 4px;
      --radius-md: 8px;
      --radius-lg: 12px;

      /* Transitions */
      --transition-fast: 0.2s ease;

      /* Shadows */
      --shadow-default: 0 4px 20px rgba(0, 0, 0, var(--shadow-strength));
      --shadow-subtle: 0 2px 8px rgba(0, 0, 0, calc(var(--shadow-strength) * 0.6));

      /* Layout */
      --container-max-width: 600px;

      /* Borders */
      --border-thin: 1px;
      --border-medium: 2px;
      --border-thick: 4px;

      /* Components */
      --option-key-size: 30px;
    }

    /* Light theme */
    [data-theme="light"] {
      --color-primary: #CC7A00;
      /* Darker Orange for better contrast */
      --color-primary-hover: #B36A00;
      /* Even darker Orange */
      --color-secondary: #005A8F;
      /* Darker Blue for better contrast */
      --color-secondary-hover: #004A7A;
      /* Even darker Blue */
      --color-bg-dark: #FFFFFF;
      /* White */
      --color-bg-medium: #F7F7F7;
      /* Light Gray */
      --color-bg-light: #EFEFEF;
      /* Medium Gray */
      --color-bg-lighter: #E5E5E5;
      /* Darker Gray */
      --color-text-primary: #1A1A1A;
      /* Near Black */
      --color-text-secondary: #606060;
      /* Gray Text */
      --color-border: #D0D0D0;
      /* Light Border */
      --color-border-hover: #B0B0B0;
      /* Hover Border */
      --color-border-light: #C0C0C0;
      /* Light Border */
      --color-error: #D55E00;
      /* Vermillion/Red-Orange */
      --color-correct-bg: rgba(0, 158, 115, 0.1);
      /* Green tint with transparency */
      --color-incorrect-bg: rgba(213, 94, 0, 0.1);
      /* Vermillion tint with transparency */
      --color-accent-green: #009E73;
      /* Green from Wong palette */
      --color-code-bg: #F5F5F5;
      /* Light code background */
      --shadow-strength: 0.15;

      /* Syntax highlighting colors for light mode */
      --syntax-keyword: #0072B2;
      /* Blue from Wong palette */
      --syntax-string: #009E73;
      /* Green from Wong palette */
      --syntax-number: #CC7A00;
      /* Darker orange for contrast */
      --syntax-operator: #D55E00;
      /* Vermillion from Wong palette */
      --syntax-function: #CC7A00;
      /* Darker orange for contrast */
      --syntax-comment: #606060;
      /* Gray */
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-system);
      background-color: var(--color-bg-dark);
      color: var(--color-text-primary);
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: var(--spacing-xl);
      line-height: var(--line-height);
      overflow: hidden;
    }

    .container {
      max-width: 800px;
      width: 100%;
      text-align: center;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    header {
      text-align: center;
      margin-bottom: var(--spacing-4xl);
    }

    /* Hide header during quiz and results */
    #quizScreen:not(.hidden)~.container header,
    #resultsScreen:not(.hidden)~.container header,
    .quiz-active header {
      display: none;
    }

    /* Compact layout for quiz screens */
    .quiz-layout {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      height: 100vh;
      padding: var(--spacing-xl) 0;
    }

    .quiz-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    h1 {
      font-size: 4rem;
      margin-bottom: var(--spacing-lg);
      color: var(--color-primary);
      font-family: var(--font-mono);
      font-weight: bold;
    }

    .subtitle {
      color: var(--color-text-secondary);
      font-size: var(--font-size-xl);
      margin-bottom: var(--spacing-4xl);
    }

    .progress {
      margin-bottom: var(--spacing-xl);
      text-align: center;
      color: var(--color-text-secondary);
      font-size: var(--font-size-base);
      position: absolute;
      top: var(--spacing-xl);
      left: 50%;
      transform: translateX(-50%);
      z-index: 100;
    }

    .question-container {
      margin-bottom: var(--spacing-xl);
    }

    .code-block {
      background-color: var(--color-code-bg);
      border: var(--border-medium) solid var(--color-border);
      border-radius: var(--radius-lg);
      padding: var(--spacing-xl);
      margin-bottom: var(--spacing-xl);
      font-family: var(--font-mono);
      font-size: 1.25rem;
      color: var(--color-text-primary);
      overflow-x: auto;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, calc(var(--shadow-strength) * 0.6));
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Syntax highlighting styles */
    .syntax-keyword {
      color: var(--syntax-keyword);
      font-weight: bold;
    }

    .syntax-string {
      color: var(--syntax-string);
    }

    .syntax-number {
      color: var(--syntax-number);
    }

    .syntax-operator {
      color: var(--syntax-operator);
    }

    .syntax-function {
      color: var(--syntax-function);
      font-weight: bold;
    }

    .syntax-comment {
      color: var(--syntax-comment);
      font-style: italic;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-lg);
      max-width: 600px;
      margin: 0 auto;
    }

    .option {
      background-color: var(--color-bg-light);
      border: var(--border-medium) solid var(--color-border);
      border-radius: var(--radius-lg);
      padding: var(--spacing-lg) var(--spacing-xl);
      cursor: pointer;
      transition: all var(--transition-fast);
      display: flex;
      align-items: center;
      gap: var(--spacing-lg);
      position: relative;
      font-size: var(--font-size-base);
    }

    .option:hover:not(.disabled) {
      background-color: var(--color-bg-lighter);
      border-color: var(--color-border-hover);
      transform: translateY(-1px);
    }

    .option.selected {
      border-color: var(--color-primary);
      background-color: rgba(230, 159, 0, 0.15);
      /* Orange tint */
    }

    .option.correct {
      border-color: var(--color-accent-green);
      background-color: var(--color-correct-bg);
    }

    .option.incorrect {
      border-color: var(--color-error);
      background-color: var(--color-incorrect-bg);
    }

    .option.disabled {
      cursor: not-allowed;
      opacity: 0.7;
    }

    .option-key {
      background-color: var(--color-border-light);
      color: var(--color-text-primary);
      width: 32px;
      height: 32px;
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      flex-shrink: 0;
      font-size: var(--font-size-base);
    }

    .option-text {
      font-family: var(--font-mono);
      flex: 1;
    }

    .explanation {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: var(--spacing-lg);
      margin-bottom: var(--spacing-xl);
      padding: var(--spacing-lg);
      padding-left: calc(var(--spacing-lg) + 40px);
      /* Extra space for icon */
      background-color: var(--color-bg-light);
      border-radius: var(--radius-md);
      border-left: var(--border-thick) solid var(--color-accent-green);
      opacity: 0;
      visibility: hidden;
      transition: opacity var(--transition-fast), visibility var(--transition-fast);
      font-size: var(--font-size-lg);
      position: relative;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      min-height: 100px;
      /* Reserve minimum space */
    }

    .explanation.correct {
      border-left-color: var(--color-accent-green);
      background-color: var(--color-correct-bg);
    }

    .explanation.incorrect {
      border-left-color: var(--color-error);
      background-color: var(--color-incorrect-bg);
    }

    .explanation-icon {
      position: absolute;
      top: 50%;
      left: var(--spacing-lg);
      transform: translateY(-50%);
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 16px;
    }

    .explanation-icon.correct {
      background-color: var(--color-accent-green);
      color: white;
    }

    .explanation-icon.incorrect {
      background-color: var(--color-error);
      color: white;
    }


    .button {
      background-color: var(--color-primary);
      color: var(--color-bg-dark);
      border: none;
      border-radius: var(--radius-lg);
      padding: var(--spacing-lg) var(--spacing-3xl);
      font-size: var(--font-size-lg);
      font-weight: bold;
      cursor: pointer;
      transition: all var(--transition-fast);
      margin-top: var(--spacing-xl);
      max-width: 250px;
      width: 100%;
    }

    .button:hover {
      background-color: var(--color-primary-hover);
      transform: translateY(-1px);
    }

    .button:active {
      transform: translateY(0);
    }

    /* Position quiz buttons at bottom */
    .quiz-active .button {
      position: absolute;
      bottom: var(--spacing-xl);
      left: 50%;
      transform: translateX(-50%);
    }

    .quiz-active .button:hover {
      background-color: var(--color-primary-hover);
      transform: translateX(-50%) translateY(-1px);
    }

    .quiz-active .button:active {
      transform: translateX(-50%) translateY(0);
    }

    .start-screen,
    .results-screen {
      text-align: center;
    }

    .results-screen h2 {
      font-size: 3rem;
      margin-bottom: var(--spacing-4xl);
      color: var(--color-primary);
    }

    .score {
      font-size: 5rem;
      margin: var(--spacing-4xl) 0;
      color: var(--color-primary);
      font-weight: bold;
    }

    .share-button {
      background-color: var(--color-secondary);
      margin-top: var(--spacing-xl);
    }

    .share-button:hover {
      background-color: var(--color-secondary-hover);
    }

    .hidden {
      display: none;
    }

    .timezone-note {
      font-size: var(--font-size-sm);
      color: var(--color-text-secondary);
      margin-top: calc(var(--spacing-sm) + 2px);
      font-style: italic;
    }

    @media (max-width: 600px) {
      body {
        padding: var(--spacing-sm);
      }

      h1 {
        font-size: 2.5rem;
      }

      .subtitle {
        font-size: var(--font-size-lg);
        margin-bottom: var(--spacing-xl);
      }

      .code-block {
        font-size: var(--font-size-base);
        padding: var(--spacing-lg);
        margin-bottom: var(--spacing-lg);
      }

      .options {
        gap: var(--spacing-md);
      }

      .option {
        padding: var(--spacing-md) var(--spacing-lg);
        font-size: var(--font-size-sm);
      }

      .option-key {
        width: 28px;
        height: 28px;
        font-size: var(--font-size-sm);
      }

      .button {
        font-size: var(--font-size-base);
        padding: var(--spacing-md) var(--spacing-xl);
        max-width: 200px;
        bottom: var(--spacing-md);
      }

      .progress {
        top: var(--spacing-md);
        font-size: var(--font-size-sm);
      }

      .score {
        font-size: 3rem;
      }

      .results-screen h2 {
        font-size: 2rem;
      }

      .question-container {
        margin-bottom: var(--spacing-md);
      }

      .explanation {
        font-size: var(--font-size-base);
        padding: var(--spacing-md);
        padding-left: calc(var(--spacing-md) + 32px);
        min-height: 80px;
      }

      .explanation-icon {
        width: 20px;
        height: 20px;
        font-size: 14px;
        left: var(--spacing-md);
      }
    }

    .toast {
      position: fixed;
      bottom: var(--spacing-xl);
      left: 50%;
      transform: translateX(-50%);
      background-color: var(--color-primary);
      color: var(--color-bg-dark);
      padding: var(--spacing-md) calc(var(--spacing-xl) + var(--spacing-xs));
      border-radius: var(--radius-md);
      font-weight: bold;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .toast.show {
      opacity: 1;
    }

    /* Theme toggle button */
    .theme-toggle {
      position: fixed;
      top: var(--spacing-xl);
      right: var(--spacing-xl);
      background-color: var(--color-bg-light);
      border: var(--border-medium) solid var(--color-border);
      border-radius: var(--radius-md);
      padding: var(--spacing-sm) var(--spacing-md);
      cursor: pointer;
      transition: all var(--transition-fast);
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      font-size: var(--font-size-base);
      color: var(--color-text-primary);
    }

    .theme-toggle:hover {
      background-color: var(--color-bg-lighter);
      border-color: var(--color-border-hover);
      transform: translateY(-1px);
    }

    .theme-toggle:active {
      transform: translateY(0);
    }

    .theme-icon {
      width: 20px;
      height: 20px;
      display: block;
    }

    /* Hide/show icons based on theme */
    [data-theme="light"] .moon-icon {
      display: none;
    }

    [data-theme="dark"] .sun-icon,
    :root:not([data-theme]) .sun-icon {
      display: none;
    }

    @media (max-width: 600px) {
      .theme-toggle {
        top: var(--spacing-md);
        right: var(--spacing-md);
        padding: var(--spacing-xs) var(--spacing-sm);
      }
    }
  </style>
</head>

<body>
  <!-- Theme toggle button -->
  <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme">
    <svg class="theme-icon sun-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
    <svg class="theme-icon moon-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
    </svg>
  </button>

  <div class="container">
    <header>
      <h1 id="main-title">new Date("wtf")</h1>
      <p class="subtitle">A quiz about JavaScript's Date weirdness</p>
    </header>

    <div id="startScreen" class="start-screen">
      <p style="margin-bottom: var(--spacing-3xl);">Think you understand JavaScript's Date constructor? Think again!
        This quiz
        explores the bizarre and unexpected behaviors of Date parsing.</p>
      <button class="button" onclick="startQuiz()">Start Quiz</button>
    </div>

    <div id="quizScreen" class="hidden">
      <div class="progress">
        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
      </div>

      <div class="question-container">
        <div class="code-block" id="codeBlock"></div>
        <div id="timezoneNote" class="timezone-note hidden"></div>
        <div class="explanation" id="explanation"></div>
        <div class="options" id="options"></div>
      </div>

      <button id="nextButton" class="button hidden" onclick="nextQuestion()">Next Question</button>
    </div>

    <div id="resultsScreen" class="results-screen hidden">
      <h2>Quiz Complete!</h2>
      <div class="score">
        <span id="correctCount">0</span> / <span id="totalCount">0</span>
      </div>
      <p id="resultMessage"></p>
      <button class="button share-button" onclick="shareResults()">Share Results</button>
      <button class="button" onclick="restartQuiz()">Try Again</button>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <script>
    function getTheme() {
      return localStorage.getItem('theme') || 'dark';
    }

    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
    }

    function toggleTheme() {
      const currentTheme = getTheme();
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      setTheme(newTheme);
    }

    document.addEventListener('DOMContentLoaded', () => {
      setTheme(getTheme());
      // Add syntax highlighting to main title
      const mainTitle = document.getElementById('main-title');
      if (mainTitle) {
        mainTitle.innerHTML = highlightJS('new Date("wtf")');
      }
    });

    setTheme(getTheme());

    function highlightJS(code) {
      const keywords = new Set([
        'new', 'function', 'var', 'let', 'const', 'if', 'else', 'for', 'while', 'do',
        'switch', 'case', 'break', 'continue', 'return', 'try', 'catch', 'finally',
        'throw', 'typeof', 'instanceof', 'in', 'of', 'class', 'extends', 'super',
        'static', 'import', 'export', 'from', 'default', 'async', 'await', 'yield',
        'delete', 'void', 'this', 'null', 'undefined', 'true', 'false'
      ]);

      const operators = new Set([
        '+', '-', '*', '/', '%', '=', '!', '<', '>', '&', '|', '^', '~', '?', ':',
        ';', ',', '.', '(', ')', '[', ']', '{', '}'
      ]);

      function tokenize(code) {
        const tokens = [];
        let i = 0;

        while (i < code.length) {
          const char = code[i];

          // Skip whitespace
          if (/\s/.test(char)) {
            let whitespace = '';
            while (i < code.length && /\s/.test(code[i])) {
              whitespace += code[i];
              i++;
            }
            tokens.push({ type: 'whitespace', value: whitespace });
            continue;
          }

          // String literals
          if (char === '"' || char === "'") {
            const quote = char;
            let string = char;
            i++;

            while (i < code.length && code[i] !== quote) {
              if (code[i] === '\\' && i + 1 < code.length) {
                string += code[i] + code[i + 1];
                i += 2;
              } else {
                string += code[i];
                i++;
              }
            }

            if (i < code.length) {
              string += code[i]; // closing quote
              i++;
            }

            tokens.push({ type: 'string', value: string });
            continue;
          }

          // Numbers
          if (/\d/.test(char)) {
            let number = '';
            while (i < code.length && /[\d.]/.test(code[i])) {
              number += code[i];
              i++;
            }
            tokens.push({ type: 'number', value: number });
            continue;
          }

          // Identifiers and keywords
          if (/[a-zA-Z_$]/.test(char)) {
            let identifier = '';
            while (i < code.length && /[a-zA-Z0-9_$]/.test(code[i])) {
              identifier += code[i];
              i++;
            }

            // Check if it's followed by parentheses (function call)
            let j = i;
            while (j < code.length && /\s/.test(code[j])) j++;

            if (j < code.length && code[j] === '(') {
              tokens.push({ type: 'function', value: identifier });
            } else if (keywords.has(identifier)) {
              tokens.push({ type: 'keyword', value: identifier });
            } else {
              tokens.push({ type: 'identifier', value: identifier });
            }
            continue;
          }

          // Operators and punctuation
          if (operators.has(char)) {
            tokens.push({ type: 'operator', value: char });
            i++;
            continue;
          }

          // Everything else
          tokens.push({ type: 'other', value: char });
          i++;
        }

        return tokens;
      }

      function tokensToHtml(tokens) {
        return tokens.map(token => {
          switch (token.type) {
            case 'keyword':
              return `<span class="syntax-keyword">${token.value}</span>`;
            case 'string':
              return `<span class="syntax-string">${token.value}</span>`;
            case 'number':
              return `<span class="syntax-number">${token.value}</span>`;
            case 'function':
              return `<span class="syntax-function">${token.value}</span>`;
            case 'operator':
              return `<span class="syntax-operator">${token.value}</span>`;
            default:
              return token.value;
          }
        }).join('');
      }

      const tokens = tokenize(code);
      return tokensToHtml(tokens);
    }

    const rawQuestions = [
      // Basic number/string confusion
      {
        code: 'new Date("0")',
        options: [
          '1970-01-01T00:00:00.000Z',
          '2000-01-01T00:00:00.000Z',
          'Invalid Date',
          'Throws an error'
        ],
        correct: 1,
        explanation: 'The string "0" is interpreted as the year 2000, not as a timestamp!'
      },
      {
        code: 'new Date(0)',
        options: [
          '1970-01-01T00:00:00.000Z',
          '2000-01-01T00:00:00.000Z',
          'Invalid Date',
          'Throws an error'
        ],
        correct: 0,
        explanation: 'The number 0 is interpreted as milliseconds since the Unix epoch (Jan 1, 1970).'
      },
      {
        code: 'Date.parse(0) === Date.parse("0")',
        options: [
          'true',
          'false',
          'Throws an error',
          'undefined'
        ],
        correct: 0,
        explanation: 'Both parse to 946684800000 milliseconds! The number 0 is coerced to the string "0".'
      },

      // Invalid dates that are still Date objects
      {
        code: 'new Date("not a date")',
        options: [
          'null',
          'undefined',
          'Invalid Date',
          'Throws an error'
        ],
        correct: 2,
        explanation: 'Invalid Date is still a Date object! It\'s not null or an error.'
      },
      {
        code: 'new Date("not a date").getTime()',
        options: [
          '0',
          'NaN',
          'null',
          'Throws an error'
        ],
        correct: 1,
        explanation: 'Invalid Date objects return NaN for getTime().'
      },
      {
        code: 'new Date("not a date").toISOString()',
        options: [
          '"Invalid Date"',
          'null',
          'NaN',
          'Throws a RangeError'
        ],
        correct: 3,
        explanation: 'toISOString() throws a RangeError on Invalid Date objects.'
      },
      {
        code: 'new Date("not a date").toTimeString()',
        options: [
          '"Invalid Date"',
          '""',
          'null',
          'Throws an error'
        ],
        correct: 0,
        explanation: 'toTimeString() returns the string "Invalid Date" for invalid dates.'
      },

      // Single/double digit parsing
      {
        code: 'new Date("1")',
        options: [
          '1970-01-01T00:00:01.000Z',
          '2001-01-01T00:00:00.000Z',
          '0001-01-01T00:00:00.000Z',
          'Invalid Date'
        ],
        correct: 1,
        explanation: 'Single digit "1" is interpreted as year 2001, not as 1 millisecond or year 1!'
      },
      {
        code: 'new Date("2")',
        options: [
          '2002-01-01T00:00:00.000Z',
          '2001-01-02T00:00:00.000Z',
          '2001-02-01T00:00:00.000Z',
          'Invalid Date'
        ],
        correct: 2,
        explanation: '"2" after "1" adds a month, not a year! So it\'s February 2001.'
      },
      {
        code: 'new Date("99") > new Date("100")',
        options: [
          'true',
          'false',
          'Throws an error',
          'Both are Invalid Date'
        ],
        correct: 0,
        explanation: '"99" is year 1999, while "100" is year 0100. 1999 > 0100!'
      },
      {
        code: 'new Date("13")',
        options: [
          '2013-01-01T00:00:00.000Z',
          '2001-01-13T00:00:00.000Z',
          '2001-13-01T00:00:00.000Z',
          'Invalid Date'
        ],
        correct: 3,
        explanation: '"13" would be month 13, which doesn\'t exist, so it\'s Invalid Date.'
      },
      {
        code: 'new Date("12")',
        options: [
          '2012-01-01T00:00:00.000Z',
          '2001-01-12T00:00:00.000Z',
          '2001-12-01T00:00:00.000Z',
          'Invalid Date'
        ],
        correct: 2,
        explanation: '"12" is interpreted as December 2001 (month 12).'
      },

      // Decimal weirdness
      {
        code: 'new Date("12.0")',
        options: [
          '2012-01-01T00:00:00.000Z',
          '2001-12-01T00:00:00.000Z',
          '2001-01-12T00:00:00.000Z',
          'Invalid Date'
        ],
        correct: 3,
        explanation: 'Adding ".0" makes it invalid, even though 12.0 === 12 in JavaScript!'
      },
      {
        code: 'new Date("12.1")',
        options: [
          '2001-12-01T00:00:00.100Z',
          '2001-01-01T00:00:00.000Z',
          '2012-01-01T00:00:00.000Z',
          'Invalid Date'
        ],
        correct: 1,
        explanation: '"12.1" is somehow valid and gives January 2001. The parser gives up on the decimal.'
      },

      // Text prefix parsing
      {
        code: 'new Date("perhaps 1")',
        options: [
          'Invalid Date',
          '2001-01-01T00:00:00.000Z',
          '1970-01-01T00:00:01.000Z',
          'Throws an error'
        ],
        correct: 1,
        explanation: 'Leading text is ignored! It finds the "1" and parses it as year 2001.'
      },
      {
        code: 'new Date("maybe 1")',
        options: [
          '2001-01-01T00:00:00.000Z',
          '2001-04-30T23:00:00.000Z',
          '2001-05-01T00:00:00.000Z',
          'Invalid Date'
        ],
        correct: 1,
        explanation: '"may" in "maybe" is parsed as the month May! Then "be 1" becomes day 1.',
        timezoneNote: 'Note: The exact time may vary based on your timezone.'
      },
      {
        code: 'new Date("fourth of may 2010")',
        options: [
          'Invalid Date',
          '2010-05-04T00:00:00.000Z',
          '2010-04-30T23:00:00.000Z',
          '2010-05-01T00:00:00.000Z'
        ],
        correct: 2,
        explanation: 'It parses "fourth" as 4, finds "may" as the month, and 2010 as the year.',
        timezoneNote: 'Note: The exact time may vary based on your timezone.'
      },

      // Parentheses magic
      {
        code: 'new Date("1990 2010")',
        options: [
          '1990-01-01T00:00:00.000Z',
          '2010-01-01T00:00:00.000Z',
          '2000-01-01T00:00:00.000Z',
          'Invalid Date'
        ],
        correct: 3,
        explanation: 'Two years without parentheses confuses the parser - Invalid Date.'
      },
      {
        code: 'new Date("1990 (2010)")',
        options: [
          '1990-01-01T00:00:00.000Z',
          '2010-01-01T00:00:00.000Z',
          '2000-01-01T00:00:00.000Z',
          'Invalid Date'
        ],
        correct: 0,
        explanation: 'Parentheses make the parser ignore what\'s inside! Uses 1990.'
      },
      {
        code: 'new Date("(1990) 2010")',
        options: [
          '1990-01-01T00:00:00.000Z',
          '2010-01-01T00:00:00.000Z',
          '2000-01-01T00:00:00.000Z',
          'Invalid Date'
        ],
        correct: 1,
        explanation: 'With the first year in parentheses, it\'s ignored and 2010 is used!'
      }
    ];

    // Pre-process all questions to add syntax highlighting
    const questions = rawQuestions.map(question => ({
      ...question,
      highlightedCode: highlightJS(question.code)
    }));

    let currentQuestionIndex = 0;
    let score = 0;
    let answered = false;

    function startQuiz() {
      document.getElementById('startScreen').classList.add('hidden');
      document.getElementById('quizScreen').classList.remove('hidden');
      document.getElementById('totalQuestions').textContent = questions.length;
      document.body.classList.add('quiz-active');
      showQuestion();
    }

    function showQuestion() {
      const question = questions[currentQuestionIndex];
      document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
      document.getElementById('codeBlock').innerHTML = question.highlightedCode;

      const optionsContainer = document.getElementById('options');
      optionsContainer.innerHTML = '';

      question.options.forEach((option, index) => {
        const optionDiv = document.createElement('div');
        optionDiv.className = 'option';
        optionDiv.onclick = () => selectOption(index);

        const keyDiv = document.createElement('div');
        keyDiv.className = 'option-key';
        keyDiv.textContent = (index + 1).toString();

        const textDiv = document.createElement('div');
        textDiv.className = 'option-text';
        textDiv.textContent = option;

        optionDiv.appendChild(keyDiv);
        optionDiv.appendChild(textDiv);
        optionsContainer.appendChild(optionDiv);
      });

      const explanation = document.getElementById('explanation');
      explanation.classList.remove('correct', 'incorrect');
      explanation.innerHTML = '';
      explanation.style.opacity = '0';
      explanation.style.visibility = 'hidden';
      document.getElementById('nextButton').classList.add('hidden');

      if (question.timezoneNote) {
        document.getElementById('timezoneNote').textContent = question.timezoneNote;
        document.getElementById('timezoneNote').classList.remove('hidden');
      } else {
        document.getElementById('timezoneNote').classList.add('hidden');
      }

      answered = false;
    }

    function selectOption(index) {
      if (answered) return;

      answered = true;
      const question = questions[currentQuestionIndex];
      const options = document.querySelectorAll('.option');

      options[index].classList.add('selected');

      const isCorrect = index === question.correct;

      if (isCorrect) {
        options[index].classList.add('correct');
        score++;
      } else {
        options[index].classList.add('incorrect');
        options[question.correct].classList.add('correct');
      }

      options.forEach(option => option.classList.add('disabled'));

      const explanation = document.getElementById('explanation');
      explanation.innerHTML = `
        <div class="explanation-icon ${isCorrect ? 'correct' : 'incorrect'}">
          ${isCorrect ? '✓' : '✗'}
        </div>
        ${question.explanation}
      `;
      explanation.style.opacity = '1';
      explanation.style.visibility = 'visible';
      explanation.classList.add(isCorrect ? 'correct' : 'incorrect');

      document.getElementById('nextButton').classList.remove('hidden');
    }

    function nextQuestion() {
      currentQuestionIndex++;
      if (currentQuestionIndex < questions.length) {
        showQuestion();
      } else {
        showResults();
      }
    }

    function showResults() {
      document.getElementById('quizScreen').classList.add('hidden');
      document.getElementById('resultsScreen').classList.remove('hidden');
      document.getElementById('correctCount').textContent = score;
      document.getElementById('totalCount').textContent = questions.length;

      const percentage = Math.round((score / questions.length) * 100);
      let message = '';

      if (percentage === 100) {
        message = 'Perfect! You truly understand the madness of JavaScript dates!';
      } else if (percentage >= 80) {
        message = 'Excellent! You know your way around Date weirdness.';
      } else if (percentage >= 60) {
        message = 'Good job! JavaScript dates are tricky.';
      } else if (percentage >= 40) {
        message = 'Not bad! Date parsing is genuinely confusing.';
      } else {
        message = 'JavaScript dates are weird, aren\'t they?';
      }

      document.getElementById('resultMessage').textContent = message;
    }

    function shareResults() {
      const score = document.getElementById('correctCount').textContent;
      const total = document.getElementById('totalCount').textContent;
      const text = `I scored ${score}/${total} on the JavaScript Date WTF Quiz! 🗓️\n\nThink you know JS dates? Try it at jsdate.wtf`;

      if (navigator.share) {
        navigator.share({
          text: text
        });
      } else {
        navigator.clipboard.writeText(text);
        showToast('Results copied to clipboard!');
      }
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    function restartQuiz() {
      currentQuestionIndex = 0;
      score = 0;
      document.getElementById('resultsScreen').classList.add('hidden');
      document.getElementById('startScreen').classList.remove('hidden');
      document.body.classList.remove('quiz-active');
    }

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (document.getElementById('quizScreen').classList.contains('hidden')) return;

      if (e.key >= '1' && e.key <= '4' && !answered) {
        selectOption(parseInt(e.key) - 1);
      } else if ((e.key === 'Enter' || e.key === ' ') && answered) {
        e.preventDefault();
        nextQuestion();
      }
    });
  </script>
</body>

</html>
